{% extends 'hqwebapp/base.html' %}
{% load menu_tags %}
{% load hq_shared_tags %}

{# stuff to override old styles -- remove when everything is migrated over #}
{% block oldstyle_tag %}{% endblock %}
{% block oldstyle_imports %}{% endblock %}
{% block oldstyle_hack_start %}{% endblock %}
{% block oldstyle_hack_end %}{% endblock %}

{% block layout_style %}hq-double-col{% endblock %}

{% block keyboard_shortcuts %}{{ block.super }}
    <script>
        var nav_key = {{ request.couch_user.keyboard_shortcuts.main_key|JSON }};
        function gen_sidebar_elements() {
            return $('.sidebar .nav-list a');
        }
        var sidebar_navigator = new KeyboardNavigator();
        sidebar_navigator.init({
            name: 'sidebar',
            nav_key: nav_key,
            action_key: 'enter',
            forward_keys: ['j', 'down'],
            back_keys: ['k', 'up'],
            element_list_generator: gen_sidebar_elements,
            reset_index: false
        });

        function gen_tab_elements() {
            return $("[data-toggle='tab']");
        }
        var tab_navigator = new KeyboardNavigator();
        tab_navigator.init({
            name: 'tabs',
            nav_key: nav_key,
            action_key: 'enter',
            element_list_generator: gen_tab_elements,
            reset_index: false
        });
    </script>
{% endblock %}

{% block content %}
    <style>
        #wrapper {
            height: 100%;
            padding-left: 0;
            -webkit-transition: all 0.5s ease;
            -moz-transition: all 0.5s ease;
            -o-transition: all 0.5s ease;
            transition: all 0.5s ease;
        }

        #wrapper.toggled {
            padding-left: 290px;
        }

        #sidebar-wrapper {
            z-index: 1000;
            position: relative;
            width: 0;
            height: 100%;
            margin-left: -290px;
            overflow-y: auto;
            overflow-x: hidden;
            word-break: normal;
            background-color: #f4f4f4 !important;
            -webkit-transition: all 0.5s ease;
            -moz-transition: all 0.5s ease;
            -o-transition: all 0.5s ease;
            transition: all 0.5s ease;
        }

        #wrapper.toggled #sidebar-wrapper {
            width: 290px;
        }

        #page-content-wrapper {
            width: 100%;
            padding: 15px;
        }

        #wrapper.toggled #page-content-wrapper {
            position: absolute;
            margin-right: -290px;
        }

        /* Sidebar Styles */

        .sidebar-nav {
            top: 0;
            width: 290px;
            margin: 0;
            padding: 0;
            list-style: none;
        }

        .sidebar-nav li a:active,
        .sidebar-nav li a:focus {
            text-decoration: none;
        }

        .sidebar-nav > .sidebar-brand {
            height: 65px;
            font-size: 18px;
            line-height: 60px;
        }

        .sidebar-nav > .sidebar-brand a {
            color: #999999;
        }

        .sidebar-nav > .sidebar-brand a:hover {
            color: #fff;
            background: none;
        }

        @media (min-width: 768px) {
            #wrapper {
                padding-left: 290px;
            }

            #wrapper.toggled {
                padding-left: 0;
            }

            #sidebar-wrapper {
                width: 290px;
            }

            #wrapper.toggled #sidebar-wrapper {
                width: 0;
            }

            #page-content-wrapper {
                padding: 20px;
            }

            #wrapper.toggled #page-content-wrapper {
                position: relative;
                margin-right: 0;
            }
        }
    </style>
    <div id="wrapper" class="row-fluid">
        <div id="sidebar-wrapper" class="sidebar span2">
            {% block sidebar %}
                {% format_sidebar %}
            {% endblock %}
        </div>
        <div id="page-content-wrapper" class="hq-content span10 {% block column_style %}{% endblock %} ">
            {% block main_column %}{% endblock %}
        </div>
    </div>
{% endblock content %}
